{"ast":null,"code":"import _regeneratorRuntime from\"/home/swapnil/Desktop/React/vidly/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/swapnil/Desktop/React/vidly/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/swapnil/Desktop/React/vidly/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/swapnil/Desktop/React/vidly/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/swapnil/Desktop/React/vidly/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/swapnil/Desktop/React/vidly/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import Joi from\"joi-browser\";import Form from\"./common/form\";import{getGenres}from\"./services/genreService\";import{getMovie}from\"./services/movieService\";import{saveMovie}from\"./services/movieService\";var MovieForm=/*#__PURE__*/function(_Form){_inherits(MovieForm,_Form);var _super=_createSuper(MovieForm);function MovieForm(){var _this;_classCallCheck(this,MovieForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:{title:\"\",genreId:\"\",numberInStock:\"\",dailyRentalRate:\"\"},genres:[],errors:{}};_this.schema={_id:Joi.string(),title:Joi.string().required().label(\"Title\"),numberInStock:Joi.number().min(0).max(10).required().label(\"Number In Stock\"),dailyRentalRate:Joi.number().required().label(\"Daily Rental Rate\"),genreId:Joi.string().required().label(\"Genre \")};_this.doSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return saveMovie(_this.state.data);case 2:_this.props.history.push(\"/movies\");case 3:case\"end\":return _context.stop();}}},_callee);}));return _this;}_createClass(MovieForm,[{key:\"populateGenres\",value:function(){var _populateGenres=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$getGenres,genres;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getGenres();case 2:_yield$getGenres=_context2.sent;genres=_yield$getGenres.data;this.setState({genres:genres});case 5:case\"end\":return _context2.stop();}}},_callee2,this);}));function populateGenres(){return _populateGenres.apply(this,arguments);}return populateGenres;}()},{key:\"populateMovie\",value:function(){var _populateMovie=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var movieId,_yield$getMovie,movie;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;movieId=this.props.match.params.id;if(!(movieId===\"new\")){_context3.next=4;break;}return _context3.abrupt(\"return\");case 4:_context3.next=6;return getMovie(movieId);case 6:_yield$getMovie=_context3.sent;movie=_yield$getMovie.data;this.setState({data:this.mapToViewModel(movie)});_context3.next=14;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](0);if(_context3.t0.response&&_context3.t0.response.status===404)this.props.history.replace(\"/not-found\");case 14:case\"end\":return _context3.stop();}}},_callee3,this,[[0,11]]);}));function populateMovie(){return _populateMovie.apply(this,arguments);}return populateMovie;}()},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.populateGenres();case 2:_context4.next=4;return this.populateMovie();case 4:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"mapToViewModel\",value:function mapToViewModel(movie){return{_id:movie._id,title:movie.title,genreId:movie.genre._id,numberInStock:movie.numberInstock,dailyRentalRate:movie.dailyRentalRate};}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,\"Movie Form\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},this.renderInput(\"title\",\"Title\"),this.renderSelect(\"genreId\",\"Genre\",this.state.genres),this.renderInput(\"numberInStock\",\"Number In Stock\",\"number\"),this.renderInput(\"dailyRentalRate\",\"Rate\"),this.renderButton(\"Save\")));}}]);return MovieForm;}(Form);export default MovieForm;","map":{"version":3,"sources":["/home/swapnil/Desktop/React/vidly/src/components/movieForms.jsx"],"names":["React","Joi","Form","getGenres","getMovie","saveMovie","MovieForm","state","data","title","genreId","numberInStock","dailyRentalRate","genres","errors","schema","_id","string","required","label","number","min","max","doSubmit","props","history","push","setState","movieId","match","params","id","movie","mapToViewModel","response","status","replace","populateGenres","populateMovie","genre","numberInstock","handleSubmit","renderInput","renderSelect","renderButton"],"mappings":"63BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,GAAP,KAAgB,aAAhB,CACA,MAAOC,CAAAA,IAAP,KAAiB,eAAjB,CACA,OAASC,SAAT,KAA0B,yBAA1B,CACA,OAASC,QAAT,KAAyB,yBAAzB,CACA,OAASC,SAAT,KAA0B,yBAA1B,C,GACMC,CAAAA,S,6TACJC,K,CAAQ,CACNC,IAAI,CAAE,CAAEC,KAAK,CAAE,EAAT,CAAaC,OAAO,CAAE,EAAtB,CAA0BC,aAAa,CAAE,EAAzC,CAA6CC,eAAe,CAAE,EAA9D,CADA,CAENC,MAAM,CAAE,EAFF,CAGNC,MAAM,CAAE,EAHF,C,OAMRC,M,CAAS,CACPC,GAAG,CAAEf,GAAG,CAACgB,MAAJ,EADE,CAEPR,KAAK,CAAER,GAAG,CAACgB,MAAJ,GAAaC,QAAb,GAAwBC,KAAxB,CAA8B,OAA9B,CAFA,CAGPR,aAAa,CAAEV,GAAG,CAACmB,MAAJ,GACZC,GADY,CACR,CADQ,EAEZC,GAFY,CAER,EAFQ,EAGZJ,QAHY,GAIZC,KAJY,CAIN,iBAJM,CAHR,CAQPP,eAAe,CAAEX,GAAG,CAACmB,MAAJ,GAAaF,QAAb,GAAwBC,KAAxB,CAA8B,mBAA9B,CARV,CASPT,OAAO,CAAET,GAAG,CAACgB,MAAJ,GAAaC,QAAb,GAAwBC,KAAxB,CAA8B,QAA9B,CATF,C,OA2CTI,Q,sEAAW,yJAEHlB,CAAAA,SAAS,CAAC,MAAKE,KAAL,CAAWC,IAAZ,CAFN,QAGT,MAAKgB,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,SAAxB,EAHS,sD,uVA9BsBvB,CAAAA,SAAS,E,wCAA1BU,M,kBAANL,I,CACR,KAAKmB,QAAL,CAAc,CAAEd,MAAM,CAANA,MAAF,CAAd,E,+cAKQe,O,CAAU,KAAKJ,KAAL,CAAWK,KAAX,CAAiBC,MAAjB,CAAwBC,E,MACpCH,OAAO,GAAK,K,2FACcxB,CAAAA,QAAQ,CAACwB,OAAD,C,uCAAxBI,K,iBAANxB,I,CACR,KAAKmB,QAAL,CAAc,CAAEnB,IAAI,CAAE,KAAKyB,cAAL,CAAoBD,KAApB,CAAR,CAAd,E,qFAEA,GAAI,aAAGE,QAAH,EAAe,aAAGA,QAAH,CAAYC,MAAZ,GAAuB,GAA1C,CACE,KAAKX,KAAL,CAAWC,OAAX,CAAmBW,OAAnB,CAA2B,YAA3B,E,kcAIE,MAAKC,cAAL,E,+BACA,MAAKC,aAAL,E,iOAGON,K,CAAO,CACpB,MAAO,CACLhB,GAAG,CAAEgB,KAAK,CAAChB,GADN,CAELP,KAAK,CAAEuB,KAAK,CAACvB,KAFR,CAGLC,OAAO,CAAEsB,KAAK,CAACO,KAAN,CAAYvB,GAHhB,CAILL,aAAa,CAAEqB,KAAK,CAACQ,aAJhB,CAKL5B,eAAe,CAAEoB,KAAK,CAACpB,eALlB,CAAP,CAOD,C,uCAQQ,CACP,mBACE,4CACE,2CADF,cAEE,4BAAM,QAAQ,CAAE,KAAK6B,YAArB,EACG,KAAKC,WAAL,CAAiB,OAAjB,CAA0B,OAA1B,CADH,CAEG,KAAKC,YAAL,CAAkB,SAAlB,CAA6B,OAA7B,CAAsC,KAAKpC,KAAL,CAAWM,MAAjD,CAFH,CAGG,KAAK6B,WAAL,CAAiB,eAAjB,CAAkC,iBAAlC,CAAqD,QAArD,CAHH,CAIG,KAAKA,WAAL,CAAiB,iBAAjB,CAAoC,MAApC,CAJH,CAKG,KAAKE,YAAL,CAAkB,MAAlB,CALH,CAFF,CADF,CAYD,C,uBArEqB1C,I,EAuExB,cAAeI,CAAAA,SAAf","sourcesContent":["import React from \"react\";\nimport Joi from \"joi-browser\";\nimport Form from \"./common/form\";\nimport { getGenres } from \"./services/genreService\";\nimport { getMovie } from \"./services/movieService\";\nimport { saveMovie } from \"./services/movieService\";\nclass MovieForm extends Form {\n  state = {\n    data: { title: \"\", genreId: \"\", numberInStock: \"\", dailyRentalRate: \"\" },\n    genres: [],\n    errors: {},\n  };\n\n  schema = {\n    _id: Joi.string(),\n    title: Joi.string().required().label(\"Title\"),\n    numberInStock: Joi.number()\n      .min(0)\n      .max(10)\n      .required()\n      .label(\"Number In Stock\"),\n    dailyRentalRate: Joi.number().required().label(\"Daily Rental Rate\"),\n    genreId: Joi.string().required().label(\"Genre \"),\n  };\n\n  async populateGenres() {\n    const { data: genres } = await getGenres();\n    this.setState({ genres });\n  }\n\n  async populateMovie() {\n    try {\n      const movieId = this.props.match.params.id;\n      if (movieId === \"new\") return;\n      const { data: movie } = await getMovie(movieId);\n      this.setState({ data: this.mapToViewModel(movie) });\n    } catch (ex) {\n      if (ex.response && ex.response.status === 404)\n        this.props.history.replace(\"/not-found\");\n    }\n  }\n  async componentDidMount() {\n    await this.populateGenres();\n    await this.populateMovie();\n  }\n\n  mapToViewModel(movie) {\n    return {\n      _id: movie._id,\n      title: movie.title,\n      genreId: movie.genre._id,\n      numberInStock: movie.numberInstock,\n      dailyRentalRate: movie.dailyRentalRate,\n    };\n  }\n\n  doSubmit = async () => {\n    //call the server\n    await saveMovie(this.state.data);\n    this.props.history.push(\"/movies\");\n  };\n\n  render() {\n    return (\n      <div>\n        <h1>Movie Form</h1>\n        <form onSubmit={this.handleSubmit}>\n          {this.renderInput(\"title\", \"Title\")}\n          {this.renderSelect(\"genreId\", \"Genre\", this.state.genres)}\n          {this.renderInput(\"numberInStock\", \"Number In Stock\", \"number\")}\n          {this.renderInput(\"dailyRentalRate\", \"Rate\")}\n          {this.renderButton(\"Save\")}\n        </form>\n      </div>\n    );\n  }\n}\nexport default MovieForm;\n"]},"metadata":{},"sourceType":"module"}